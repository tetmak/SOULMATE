<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Relationship Compatibility Analysis</title>
  <script src="js/theme-engine.js"></script>
  <script src="js/i18n-engine.js"></script>
  <script src="js/tailwind.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;700;800&family=Playfair+Display:ital,wght@1,700&display=swap" rel="stylesheet" />
  <script src="js/supabase.min.js"></script>
  <script src="js/supabase-config.js"></script>
  <script src="js/api-base.js"></script>
  <script src="js/auth.js"></script>
  <script src="js/profile.js"></script>
  <script src="js/avatar.js"></script>
  <script id="tailwind-config">
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
                        "background-light": "#f8f8f5",
            primary: "#bc383e",
            accent: "#f2cc0d",
            "background-dark": "#13110c",
            "card-dark": "rgba(255, 255, 255, 0.05)", "card-light": "#f5f5f0"
          },
          fontFamily: {
            display: ["Plus Jakarta Sans", "sans-serif"]
          }
        }
      }
    };
  </script>
  <style>
    :root {
      --primary-glow: rgba(188, 56, 62, 0.4);
      --accent-glow: rgba(242, 204, 13, 0.2);
    }
    body { font-family: 'Plus Jakarta Sans', sans-serif; min-height: max(884px, 100dvh); }
    .material-symbols-outlined { font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24 }
    .cosmic-bg {
      background: radial-gradient(circle at top, #2c2712 0%, #13110c 70%);
      position: relative;
    }
    html:not(.dark) .cosmic-bg {
      background: none;
    }
    .stardust {
      background-image: radial-gradient(circle, #ffffff 1px, transparent 1px);
      background-size: 40px 40px;
      opacity: 0.15;
    }
    html:not(.dark) .stardust {
      background-image: radial-gradient(circle, rgba(0,0,0,0.06) 1px, transparent 1px);
      opacity: 0.5;
    }
    .celestial-orbit {
      border: 1px solid rgba(255, 255, 255, 0.08);
      border-radius: 50%;
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }
    .glow-text {
      text-shadow: 0 0 10px var(--primary-glow);
    }
    .arc-path {
      fill: none;
      stroke-linecap: round;
    }
    @keyframes compat-pulse { 0%,100% { opacity:.4 } 50% { opacity:.9 } }
    html:not(.dark) .celestial-orbit {
      border-color: rgba(0, 0, 0, 0.08);
    }

    /* ── Soulmate Share Sheet Light Mode ── */
    html:not(.dark) #sm-sheet {
      background: #ffffff !important;
    }
    html:not(.dark) #sm-sheet > div:first-child {
      background: rgba(0,0,0,0.10) !important;
    }
    html:not(.dark) #sm-sheet h3 {
      color: #1e293b !important;
    }
    html:not(.dark) #sm-sheet > div:nth-child(2) button[onclick="smClose()"] {
      background: rgba(0,0,0,0.05) !important;
      color: #64748b !important;
      border-color: rgba(0,0,0,0.1) !important;
    }
    html:not(.dark) #sm-sheet > p,
    html:not(.dark) #sm-sheet p[style*="text-align:center"][style*="color:rgba(255"] {
      color: rgba(0,0,0,0.40) !important;
    }
    html:not(.dark) #sm-sheet button[onclick="smAction('save')"] {
      background: #f1f5f9 !important;
      border-color: rgba(0,0,0,0.08) !important;
      color: #1e293b !important;
    }
    html:not(.dark) #sm-sheet div[style*="justify-content:center;gap:40px"] button div {
      background: rgba(0,0,0,0.04) !important;
      border-color: rgba(0,0,0,0.10) !important;
    }
    html:not(.dark) #sm-sheet div[style*="justify-content:center;gap:40px"] button div .material-symbols-outlined {
      color: rgba(0,0,0,0.45) !important;
    }
    html:not(.dark) #sm-sheet div[style*="justify-content:center;gap:40px"] button > span:last-child {
      color: rgba(0,0,0,0.40) !important;
    }
  </style>
</head>

<body class="bg-background-light dark:bg-background-dark min-h-screen text-slate-900 dark:text-white font-display overflow-x-hidden">
  <div class="relative flex min-h-screen w-full flex-col cosmic-bg">
    <div class="absolute inset-0 stardust pointer-events-none"></div>

    <!-- Header -->
    <header class="relative z-20 flex items-center bg-transparent p-4 justify-between">
      <div onclick="window.location.href='compatibility_input_form.html'"
        class="flex size-12 shrink-0 items-center justify-start cursor-pointer">
        <span class="material-symbols-outlined text-slate-700 dark:text-white text-[24px]">arrow_back_ios</span>
      </div>
      <h2 class="text-slate-900 dark:text-white text-sm font-bold uppercase tracking-widest flex-1 text-center opacity-80" data-i18n="compat_analysis.header_title">Uyum Analizi</h2>
      <div class="flex size-12 items-center justify-end">
        <button onclick="openSoulmateShare()"
          class="flex items-center justify-center rounded-full h-10 w-10 bg-slate-100 dark:bg-white/5 text-slate-900 dark:text-white">
          <span class="material-symbols-outlined text-[20px]" style="pointer-events:none;font-variation-settings:'FILL' 1">favorite</span>
        </button>
      </div>
    </header>

    <main class="relative z-10 flex-1 flex flex-col pb-10">
      <!-- Celestial Orbit Section -->
      <div class="relative w-full aspect-square flex items-center justify-center py-6">
        <!-- Orbit rings -->
        <div class="celestial-orbit w-[85%] h-[85%]"></div>
        <div class="celestial-orbit w-[65%] h-[65%]"></div>
        <div class="celestial-orbit w-[45%] h-[45%]" style="border-color:rgba(188,56,62,0.2)"></div>

        <!-- SVG constellation lines -->
        <div class="absolute inset-0 flex items-center justify-center pointer-events-none opacity-40">
          <svg class="w-full h-full" viewBox="0 0 400 400">
            <line stroke="url(#lineGradient)" stroke-dasharray="4 4" stroke-width="1" x1="200" x2="80" y1="200" y2="120"></line>
            <line stroke="url(#lineGradient)" stroke-dasharray="4 4" stroke-width="1" x1="200" x2="320" y1="200" y2="120"></line>
            <path class="arc-path" stroke="rgba(188,56,62,0.4)" d="M 200,60 A 140,140 0 0 1 340,200" stroke-width="2"></path>
            <path class="arc-path" stroke="rgba(188,56,62,0.2)" d="M 60,200 A 140,140 0 0 1 200,60" stroke-width="2"></path>
            <path class="arc-path" stroke="rgba(242,204,13,0.2)" d="M 200,340 A 140,140 0 0 1 60,200" stroke-width="2"></path>
            <defs>
              <linearGradient id="lineGradient" x1="0%" x2="100%" y1="0%" y2="100%">
                <stop offset="0%" stop-color="#bc383e" stop-opacity="0"></stop>
                <stop offset="50%" stop-color="#bc383e" stop-opacity="0.5"></stop>
                <stop offset="100%" stop-color="#bc383e" stop-opacity="0"></stop>
              </linearGradient>
            </defs>
          </svg>
        </div>

        <!-- Center Score Circle -->
        <div class="relative z-20 flex flex-col items-center justify-center w-32 h-32 rounded-full bg-white/90 dark:bg-[#13110c]/80 backdrop-blur-md border border-primary/40 shadow-[0_0_30px_rgba(188,56,62,0.3)]">
          <span id="compat-overall-score" class="text-4xl font-bold text-primary glow-text leading-none">—</span>
          <span class="text-[10px] uppercase tracking-widest text-slate-500 dark:text-white/60 mt-1" data-i18n="compat_analysis.harmony_label">Uyum</span>
        </div>

        <!-- Avatar 1 (You) -->
        <div class="absolute top-[20%] left-[10%] flex flex-col items-center gap-2">
          <div class="relative">
            <div class="absolute -inset-2 rounded-full border border-primary/30"></div>
            <div id="compat-avatar-1"
              class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-20 w-20 border-2 border-slate-200 dark:border-white/10 ring-4 ring-primary/5"
              style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuARa_kKvzeVGVJsHcnNSL_nObRubBlB0X1Mr5vFpCswAUmD3pAtqdjQmwdrKwQZq7FiFzWaNTiwCjIZ1pxgK1LbPGsEH45QaiQABfIp_Ffm1bGKKy1hlsIqEbeG-xG1766WtFiFSjoyw_3as1ciE2dtJ6o0fKZO_xvbhhbuY4vUn5fX08okqb3T6Q1dCPtwFUehpvReBhnDWum6-TyfqICYoL5YDaiJ_BrOoVpi_yGR7N0WKP7bw_GfWGD-wEvi4pkwDlRgmszhCXHJ");'></div>
          </div>
          <span id="compat-name-1" class="text-xs font-bold tracking-wider bg-white/80 dark:bg-black/40 px-2 py-0.5 rounded-full border border-slate-200 dark:border-white/10 backdrop-blur-sm text-slate-900 dark:text-white" data-i18n="compat_analysis.you_name">Sen</span>
        </div>

        <!-- Avatar 2 (Partner) -->
        <div class="absolute top-[20%] right-[10%] flex flex-col items-center gap-2">
          <div class="relative">
            <div class="absolute -inset-2 rounded-full border border-primary/30"></div>
            <div id="compat-avatar-2"
              class="bg-center bg-no-repeat aspect-square bg-cover rounded-full h-20 w-20 border-2 border-slate-200 dark:border-white/10 ring-4 ring-primary/5"
              style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuA-mJcZ3567V4IDAnzrW6UY6b35eOybyGgf8V3bsohsQOTRjln_37NPDDQPFtqeR_AiUO4iz-Fzew9okA1TL9P2o1jY0B74Sfen3IWBWTrhTxp49qAfqGsn3rPCSvayLUEsoQlh-fOgJRq8WuLK5ZDcnwAv-RSUWNHcaSrE0qU2dFdUU2xfL8z6WNSvgLB6AB-eQNOkhMVv9bQ6gsU3Q-C7l_imBBdpeATNQ5ZeU36VIK65bXEH5aKossqG7N6jwr9pV3MmWdUR6xxb");'></div>
          </div>
          <span id="compat-name-2" class="text-xs font-bold tracking-wider bg-white/80 dark:bg-black/40 px-2 py-0.5 rounded-full border border-slate-200 dark:border-white/10 backdrop-blur-sm text-slate-900 dark:text-white">Partner</span>
        </div>

        <!-- Score Labels Around Orbit -->
        <div class="absolute top-[10%] left-1/2 -translate-x-1/2 flex flex-col items-center">
          <span class="text-[10px] uppercase tracking-[0.2em] text-slate-400 dark:text-white/40" data-i18n="compat_analysis.life_path_label">Kader Yolu</span>
          <span id="compat-bar-lp-score" class="text-sm font-bold text-primary">—</span>
        </div>
        <div class="absolute bottom-[22%] left-[15%] flex flex-col items-start">
          <span class="text-[10px] uppercase tracking-[0.2em] text-slate-400 dark:text-white/40" data-i18n="compat_analysis.personality_label">Kişilik</span>
          <span id="compat-bar-pers-score" class="text-sm font-bold text-primary">—</span>
        </div>
        <div class="absolute bottom-[22%] right-[15%] flex flex-col items-end">
          <span class="text-[10px] uppercase tracking-[0.2em] text-slate-400 dark:text-white/40" data-i18n="compat_analysis.soul_urge_label">Ruh Dürtüsü</span>
          <span id="compat-bar-soul-score" class="text-sm font-bold text-primary">—</span>
        </div>
        <div class="absolute bottom-[10%] left-1/2 -translate-x-1/2 flex flex-col items-center">
          <span class="text-[10px] uppercase tracking-[0.2em] text-slate-400 dark:text-white/40" data-i18n="compat_analysis.expression_label">İfade</span>
          <span id="compat-bar-exp-score" class="text-sm font-bold text-accent">—</span>
        </div>
      </div>

      <!-- Bond Label Section -->
      <div class="px-6 text-center -mt-4 mb-8">
        <h1 id="compat-bond-label" class="text-2xl font-bold tracking-tight mb-1">—</h1>
        <p id="compat-bond-sub" class="text-[#bab59c] text-xs uppercase tracking-[0.3em] font-medium opacity-60">—</p>
        <div id="compat-stars" class="flex items-center justify-center gap-1 mt-2"></div>
      </div>

      <!-- Insight Card -->
      <div class="px-5">
        <div id="compat-insight-card" class="bg-white/80 dark:bg-white/5 backdrop-blur-xl rounded-3xl p-6 border border-slate-200 dark:border-white/10 relative overflow-hidden">
          <div class="absolute top-0 right-0 p-4 opacity-20">
            <span class="material-symbols-outlined text-4xl text-primary">auto_awesome</span>
          </div>
          <div class="flex items-center gap-2 mb-4 relative z-10">
            <span class="material-symbols-outlined text-primary text-xl">temp_preferences_custom</span>
            <h3 class="text-lg font-bold" data-i18n="compat_analysis.cosmic_bond_title">Kozmik Bağ</h3>
          </div>
          <p class="text-slate-500 dark:text-white/50 text-sm leading-relaxed relative z-10" style="animation:compat-pulse 1.5s infinite;">
            <span data-i18n="compat_analysis.cosmic_bond_loading">Kozmik bağ hesaplanıyor...</span>
          </p>
        </div>
      </div>

      <!-- CTA -->
      <div class="mt-8 px-5">
        <button
          class="w-full bg-primary hover:bg-primary/90 text-white font-bold py-4 rounded-2xl transition-all active:scale-[0.98] flex items-center justify-center gap-3 shadow-lg shadow-primary/25">
          <span class="material-symbols-outlined text-xl">auto_fix_high</span>
          <span data-i18n="compat_analysis.unlock_love_guide">Tam Aşk Rehberini Aç</span>
          <span class="material-symbols-outlined text-sm opacity-60">lock</span>
        </button>
      </div>
    </main>

    <!-- Bottom Navigation Spacer -->
    <div class="h-8 bg-transparent"></div>
  </div>

  <script>
    // NUMERAEL APP - Navigation Helper
    (function () {
      var autoTarget = '';
      var autoDelay = 2500;
      if (autoTarget) {
        setTimeout(function () { window.location.href = autoTarget; }, autoDelay);
      }
      setTimeout(function () {
        var allBtns = document.querySelectorAll('button, a');
        allBtns.forEach(function (btn) {
          var text = btn.textContent || '';
          var html = btn.innerHTML || '';
          if ((text.includes('Home') || html.includes('>home<')) && text.trim().length < 20) {
            btn.addEventListener('click', function (e) { e.preventDefault(); window.location.href = 'mystic_numerology_home_1.html'; });
          }
          if (text.includes('Crystal Store') || text.includes('Journal')) {
            btn.addEventListener('click', function (e) { e.preventDefault(); window.location.href = 'premium_crystal_store.html'; });
          }
          if ((text.includes('Profile') || html.includes('>settings<')) && text.trim().length < 20) {
            btn.addEventListener('click', function (e) { e.preventDefault(); window.location.href = 'profile_soul_journey.html'; });
          }
        });
      }, 500);
    })();

    setTimeout(function () {
      document.querySelectorAll('button, a, [class*="cursor"]').forEach(function (el) {
        var txt = (el.textContent || '');
        if (txt.includes('Unlock Full Ritual') || txt.includes('Unlock Full Love Guide') || txt.includes('Tam Aşk Rehberini Aç')) {
          el.style.cursor = 'pointer';
          el.addEventListener('click', function (e) {
            e.stopPropagation();
            e.preventDefault();
            if (window.premium && window.premium.isPremium()) {
              var partnerName = '';
              try {
                var cd = JSON.parse(localStorage.getItem('numerael_compat_data') || '{}');
                partnerName = (cd.person2 && cd.person2.name) ? cd.person2.name : '';
              } catch(ex) {}
              var url = 'name_numerology_breakdown_3.html';
              if (partnerName) url += '?kisi=' + encodeURIComponent(partnerName);
              window.location.href = url;
            } else if (window.premium) {
              window.premium.showPaywall('Bu icerik Premium ozelligi.');
            }
          });
        }
      });

      document.querySelectorAll('button, a, [class*="cursor"]').forEach(function (el) {
        var txt = (el.textContent || '') + (el.innerHTML || '');
        if (txt.includes('arrow_back')) {
          el.style.cursor = 'pointer';
          el.addEventListener('click', function (e) {
            e.stopPropagation();
            window.location.href = 'compatibility_input_form.html';
          });
        }
      });
    }, 100);
  </script>

  <!-- Soulmate Share Overlay -->
  <div id="sm-overlay"
    style="display:none;position:fixed;inset:0;z-index:300;align-items:flex-end;justify-content:center;backdrop-filter:blur(8px);background:rgba(10,9,7,0.85)"
    onclick="if(event.target===this)smClose()">
    <div id="sm-sheet"
      style="width:100%;max-width:480px;background:#181711;border-radius:28px 28px 0 0;padding:20px 20px 48px;transform:translateY(100%);transition:transform 0.4s cubic-bezier(0.34,1.2,0.64,1);overflow-y:auto;max-height:94vh">

      <div style="width:40px;height:4px;background:rgba(255,255,255,0.12);border-radius:2px;margin:0 auto 16px"></div>
      <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:16px;padding:0 4px">
        <h3 style="font-size:17px;font-weight:800;color:white;font-family:'Plus Jakarta Sans',sans-serif" data-i18n="compat_analysis.share_title">Ruh Eşi Kartını Paylaş</h3>
        <button onclick="smClose()"
          style="width:32px;height:32px;background:rgba(255,255,255,0.07);border:1px solid rgba(255,255,255,0.1);border-radius:50%;color:rgba(255,255,255,0.5);cursor:pointer;font-size:17px;display:flex;align-items:center;justify-content:center;flex-shrink:0">✕</button>
      </div>

      <!-- Soulmate Card -->
      <div
        style="width:100%;max-width:300px;margin:0 auto 16px;aspect-ratio:1/1;border-radius:1.5rem;position:relative;overflow:hidden;background:linear-gradient(135deg,#fce4ec 0%,#f8bbd0 20%,#f48fb1 40%,#fff0f3 55%,#e1bee7 70%,#f8bbd0 85%,#fce4ec 100%);box-shadow:0 20px 50px rgba(233,30,99,0.2);border:1px solid rgba(233,30,99,0.15)">
        <!-- Top badge -->
        <div style="position:absolute;top:16px;left:0;right:0;display:flex;justify-content:center;align-items:center;gap:8px;z-index:2">
          <div style="width:22px;height:22px;background:#e91e63;border-radius:50%;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px rgba(233,30,99,0.4)">
            <span class="material-symbols-outlined" style="font-size:12px;color:white;pointer-events:none">favorite</span>
          </div>
          <span style="font-size:10px;text-transform:uppercase;letter-spacing:0.2em;font-weight:800;color:#880e4f;font-family:'Plus Jakarta Sans',sans-serif">Numantic</span>
        </div>
        <!-- Main content -->
        <div style="position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px 16px 16px;text-align:center">
          <h2 id="sm-names" style="font-family:Playfair Display,serif;font-size:19px;font-style:italic;font-weight:700;color:#880e4f;-webkit-text-fill-color:#880e4f;margin-bottom:14px;padding:0 4px;line-height:1.3">Alexander &amp; Sophia</h2>
          <!-- Score circle -->
          <div style="width:108px;height:108px;border-radius:50%;border:2px solid rgba(233,30,99,0.3);box-shadow:0 0 20px rgba(233,30,99,0.15);background:rgba(255,255,255,0.7);backdrop-filter:blur(8px);display:flex;flex-direction:column;align-items:center;justify-content:center;margin-bottom:14px;position:relative">
            <span id="sm-score" style="font-size:36px;font-weight:800;color:#c2185b;line-height:1;font-family:'Plus Jakarta Sans',sans-serif">94%</span>
            <span style="font-size:9px;text-transform:uppercase;letter-spacing:0.1em;color:rgba(136,14,79,0.7);font-weight:700;margin-top:4px;font-family:'Plus Jakarta Sans',sans-serif">Compatibility</span>
            <span class="material-symbols-outlined" style="position:absolute;top:-6px;right:-6px;font-size:16px;color:#e91e63">auto_awesome</span>
          </div>
          <!-- Bond label -->
          <div style="background:rgba(255,255,255,0.6);backdrop-filter:blur(8px);border:1px solid rgba(233,30,99,0.15);border-radius:16px;padding:10px 20px">
            <p id="sm-bond" style="font-size:13px;font-weight:700;color:#880e4f;font-family:'Plus Jakarta Sans',sans-serif">Divine Eternal Connection</p>
          </div>
        </div>
      </div>

      <p style="text-align:center;color:rgba(255,255,255,0.3);font-size:13px;margin-bottom:20px;font-family:'Plus Jakarta Sans',sans-serif" data-i18n="compat_analysis.share_cta">Bu kartı sevdiklerinle paylaş</p>

      <!-- Share buttons -->
      <div style="display:flex;flex-direction:column;gap:12px;margin-bottom:20px">
        <button onclick="smAction('instagram')"
          style="width:100%;height:52px;background:linear-gradient(135deg,#8b5cf6,#ec4899);border:none;border-radius:16px;display:flex;align-items:center;justify-content:space-between;padding:0 20px;cursor:pointer;color:white;font-family:'Plus Jakarta Sans',sans-serif">
          <div style="display:flex;align-items:center;gap:12px">
            <span class="material-symbols-outlined" style="font-size:22px;pointer-events:none">photo_camera</span>
            <span style="font-weight:700;font-size:15px">Instagram Stories</span>
          </div>
          <span class="material-symbols-outlined" style="font-size:20px;opacity:0.7">chevron_right</span>
        </button>
        <button onclick="smAction('whatsapp')"
          style="width:100%;height:52px;background:#25D366;border:none;border-radius:16px;display:flex;align-items:center;justify-content:space-between;padding:0 20px;cursor:pointer;color:#0a0907;font-family:'Plus Jakarta Sans',sans-serif">
          <div style="display:flex;align-items:center;gap:12px">
            <span class="material-symbols-outlined" style="font-size:22px;pointer-events:none">chat_bubble</span>
            <span style="font-weight:700;font-size:15px">WhatsApp Status</span>
          </div>
          <span class="material-symbols-outlined" style="font-size:20px;opacity:0.7">chevron_right</span>
        </button>
        <button onclick="smAction('save')"
          style="width:100%;height:52px;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.08);border-radius:16px;display:flex;align-items:center;justify-content:space-between;padding:0 20px;cursor:pointer;color:white;font-family:'Plus Jakarta Sans',sans-serif">
          <div style="display:flex;align-items:center;gap:12px">
            <span class="material-symbols-outlined" style="font-size:22px;opacity:0.7;pointer-events:none">download</span>
            <span style="font-weight:700;font-size:15px" data-i18n="compat_analysis.save_to_gallery">Galeriye Kaydet</span>
          </div>
          <span class="material-symbols-outlined" style="font-size:20px;opacity:0.7">chevron_right</span>
        </button>
      </div>

      <!-- Copy + Other -->
      <div style="display:flex;justify-content:center;gap:40px">
        <button onclick="smAction('copy')"
          style="display:flex;flex-direction:column;align-items:center;gap:8px;background:none;border:none;cursor:pointer">
          <div style="width:48px;height:48px;border-radius:50%;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);display:flex;align-items:center;justify-content:center">
            <span class="material-symbols-outlined" style="font-size:20px;color:rgba(255,255,255,0.5)">content_copy</span>
          </div>
          <span style="font-size:10px;font-weight:700;color:rgba(255,255,255,0.3);text-transform:uppercase;letter-spacing:0.1em;font-family:'Plus Jakarta Sans',sans-serif" data-i18n="compat_analysis.copy_link">Kopyala</span>
        </button>
        <button onclick="smAction('other')"
          style="display:flex;flex-direction:column;align-items:center;gap:8px;background:none;border:none;cursor:pointer">
          <div style="width:48px;height:48px;border-radius:50%;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);display:flex;align-items:center;justify-content:center">
            <span class="material-symbols-outlined" style="font-size:20px;color:rgba(255,255,255,0.5)">more_horiz</span>
          </div>
          <span style="font-size:10px;font-weight:700;color:rgba(255,255,255,0.3);text-transform:uppercase;letter-spacing:0.1em;font-family:'Plus Jakarta Sans',sans-serif" data-i18n="compat_analysis.other">Diğer</span>
        </button>
      </div>
    </div>
  </div>

  <script src="js/soulmate-share.js"></script>

  <script>
    setTimeout(function () {
      document.querySelectorAll('button').forEach(function (btn) {
        var txt = btn.textContent || '';
        if (txt.includes('Unlock Full Ritual') || txt.includes('Unlock Full Love Guide') || txt.includes('Tam Aşk Rehberini Aç')) {
          btn.addEventListener('click', function (e) {
            e.preventDefault();
            if (window.premium && window.premium.isPremium()) {
              var partnerName = '';
              try {
                var cd = JSON.parse(localStorage.getItem('numerael_compat_data') || '{}');
                partnerName = (cd.person2 && cd.person2.name) ? cd.person2.name : '';
              } catch(ex) {}
              var url = 'name_numerology_breakdown_3.html';
              if (partnerName) url += '?kisi=' + encodeURIComponent(partnerName);
              window.location.href = url;
            } else if (window.premium) {
              window.premium.showPaywall('Bu icerik Premium ozelligi.');
            }
          });
        }
      });
    }, 300);
  </script>
  <script src="js/numerology-context-engine.js?v=2"></script>
  <script src="js/decision-timing-engine.js?v=2"></script>
  <script src="js/numerology-ai.js?v=2"></script>
  <script src="js/compatibility-engine.js?v=2"></script>
  <script>
    // Fallback: Compat Engine yüklendiyse ama init çalışmadıysa, 1sn sonra tekrar dene
    setTimeout(function() {
      var scoreEl = document.getElementById('compat-overall-score');
      if (scoreEl && (scoreEl.textContent === '—' || scoreEl.textContent === '')) {
        console.log('[Compat Fallback] Engine init çalışmamış, fallback devrede');
        if (window.CompatEngine && window.CompatEngine.initCompatAnalysis) {
          window.CompatEngine.initCompatAnalysis();
        } else {
          console.error('[Compat Fallback] CompatEngine yüklenmedi!');
          try {
            var raw = JSON.parse(localStorage.getItem('numerael_compat_data') || 'null');
            if (!raw) raw = { person1: { name: 'Kişi 1', birthDate: '1990-01-01' }, person2: { name: 'Kişi 2', birthDate: '1992-01-01' } };
            var n1 = document.getElementById('compat-name-1');
            var n2 = document.getElementById('compat-name-2');
            if (n1) n1.textContent = raw.person1.name || 'Kişi 1';
            if (n2) n2.textContent = raw.person2.name || 'Kişi 2';
            scoreEl.textContent = '78%';
          } catch(e) { console.error('[Compat Fallback] Hata:', e); }
        }
      }
    }, 1000);
  </script>
  <script src="js/play-billing.js"></script>
  <script src="js/premium.js?v=2"></script>
  <script src="js/notification-engine.js?v=2"></script>
  <script src="js/bottom-nav.js?v=2"></script>
</body>
</html>
